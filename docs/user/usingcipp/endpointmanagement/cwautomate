Generate Token and Location ID using Script

Find Location ID Number:

ConnectWise Automate Thick Client:
Open CW automate Thick Client (Service Control Center) 
On the top right click on your Account Icon and go to preferences
In the preferences go make sure you show object IDs 
Take note of the LocationIDs number

ConnectWise Automate Web Client:
Browse to the Location you wish to deploy to
Review the Web Address to find https://[yourautomateserverurl.tld]?siteid=[ID] you will require just the number where [ID] is

Generate a Token:
Please import the following script Generate Agent InstallerToken - Scripts - MSPGeek to Automate by following Export and Import Scripts in ConnectWise Automate - ConnectWise

To generate a token it is easier to go to https://[yourautomateserverurl.tld]
Run the Generate Agent InstallerToken v2 script on a workstation
Press next, then fill in the details 
Please take note of the Parameter Variables:  as this explain on how to fill the values. Also this is the part where you fill in LocationID so the token relates to that LocationID
Then press run and you should receive an email in a few mins with the Token

Deploy Automate as MSP App via CIPP
Go to https://[yourcippserverurl.tld]
In the sidebar, select Intune > Applications > Add MSP App
Select the relevant tenant
Select MSP Tool as CW Automate
Assign to all users and devices (or whatever assignment works for you)
Enter Intune Application Display Name you wish to use
Enter Automate Server (including HTTPS) as https://[yourcippserverurl.tld]
Enter Installer Token and Location ID generated by the script
Then you need to go to Intune > Applications > Application Queue and press the Deploy now button
